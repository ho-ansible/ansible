---
- name: Firewall
  become: true
  gather_facts: false

  tasks:

  - name: IPTables: directory
    file: dest=/etc/iptables state=directory

  - name: IPTables rulesets
    copy: src={{item}} dest=/etc/iptables/ mode=0644 owner=root group=root
    with_items:
    - rules
    - rules.v6

  - name: Create iptables-persistent service
    copy: src=iptables-persistent dest=/etc/init.d/ mode=0755 owner=root group=root

  - name: iptables-persistent service
    service: name=iptables-persistent state=started enabled=yes
