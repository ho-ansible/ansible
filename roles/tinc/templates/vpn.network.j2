## /etc/systemd/network/20-{{ tinc_net }}.network
# per-link config of systemd-network
# {{ ansible_managed }}

[Match]
Name={{ tinc_net }}

[Network]
Description="tinc VPN {{ tinc_net }}"

{% if 'tinc' in cname | default("") %}
Address=10.100.1.{{ cname | regex_replace('^.*tinc(\\d+).*$', '\\1') }}/24
Gateway=10.100.1.1
DNS=10.100.1.1
Domains=ho.vpn
IPForward=yes

{% else %}
Domains=~.
DHCP=yes

[DHCP]
UseDomains=true
CriticalConnection=true
RouteMetric=200
{% endif %}
