---

# Spin up new VM: get IP and root password
# Add HOST to inv/_master.yml: HOST ansible_host=IP
# Add HOST to inv/_roles.yml as needed
# ansible-playbook -k -l HOST plays/setup.yml
#   (if NAT, add '-e ansible_port=NATPORT')
# ansible-playbook -l HOST plays/main.yml
# Create entry on burp server
# Manually set CNAME in DNS

- name: setup | config access
  vars:
    - ansible_user: root
    - ansible_port: 22
    - ansible_ssh_extra_args: "-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null"
  tasks:
    - import_tasks: tasks/update.yml
    - import_tasks: tasks/randpw.yml
    - import_tasks: ../roles/tinc/tasks/genkey.yml
  roles:
    - { role: sudo, tags: [new,sudo] }
    - { role: ssh, tags: [new,ssh] }
